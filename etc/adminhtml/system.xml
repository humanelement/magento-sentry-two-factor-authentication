<?xml version="1.0"?>

<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:module:Magento_Config:etc/system_file.xsd">
    <system>
        <tab id="hei" translate="label" sortOrder="999999" class="hei-tab">
            <label>Human Element</label>
        </tab>
        <section id="he2faconfig" translate="label" type="text" sortOrder="10" showInDefault="1" showInWebsite="1" showInStore="0">
            <label>Sentry Two Factor Authentication</label>
            <class>sentry-section</class>
            <tab>hei</tab>
            <resource>HE_TwoFactorAuth::config</resource>
            <group id="hint" type="text" sortOrder="0" showInDefault="1" showInWebsite="1" showInStore="0">
                <frontend_model>HE\TwoFactorAuth\Block\Adminhtml\System\Config\Fieldset\Hint</frontend_model>
            </group>
            <group id="control" translate="label" type="text" sortOrder="100" showInDefault="1" showInWebsite="1" showInStore="0">
                <label>Provider Selection</label>
                <comment>Choose an authentication provider or disable multi-factor authentication</comment>
                <field id="provider" translate="label" type="select" showInDefault="1" showInWebsite="1" showInStore="0">
                    <label>Choose Two Factor Provider</label>
                    <source_model>HE\TwoFactorAuth\Model\Sysconfig\Provider</source_model>
                    <comment>Select the security provider for authentication</comment>
                </field>
                <field id="ipwhitelist" translate="label" type="textarea" showInDefault="1" showInWebsite="1" showInStore="0">
                    <label>Whitelisted IP Addresses</label>
                    <comment>
                        <![CDATA[You may whitelist IP addresses here (one per line). Anyone logging in from a whitelisted
                     IP will not be required to perform two-factor authentication.]]>
                    </comment>
                </field>
                <field id="logaccess" translate="label" type="select" showInDefault="1" showInWebsite="1" showInStore="0">
                    <label>Enable access logging</label>
                    <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
                    <comment>
                        <![CDATA[When enabled, the module will log all access attempts and failures to a file named
                    two_factor_auth.log in Magento's log directory]]>
                    </comment>
                </field>
                <field id="logging" translate="label" type="select" showInDefault="1" showInWebsite="1" showInStore="0">
                    <label>Enable debug logging</label>
                    <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
                    <comment>
                        <![CDATA[When enabled, the module will write debugging information to a file named
                    two_factor_auth.log in Magento's log directory]]>
                    </comment>
                </field>
            </group>
            <group id="duo" type="text" sortOrder="200" showInDefault="1" showInWebsite="1" showInStore="0" translate="label">
                <label>Duo Security</label>
                <comment><![CDATA[<p><strong>About Duo Security</strong><br/>Duo Security is a leading provider of online
                Two Factor authentication. For more information, please visit their
                <a href="https://www.duosecurity.com/" target="_new">website</a>.</p>
                <p><strong>SETUP</strong> For information on setting up a new account or adding an integration please see one
                of the following:
                <ul style="padding-left:15px">
                <li>To create a Duo account, go to the <a href="https://signup.duosecurity.com/" target="_new">signup</a> page.
                <li>To get your Integration settings, please visit the
                <a href="https://admin-41c88c1d.duosecurity.com/integrations" target="_new">Integrations Control Panel</a> in your Duo account.
                <li>For information on setting up a new integration, please read
                <a href="https://www.duosecurity.com/docs/getting_started">Getting Started with Duo Security</a>
                </ul></p>
                <p>When setting up a new integration select either <strong>"Magento"</strong> or <strong>"Web SDK"</strong> as the type of integration.</p>
                <p><strong>NOTE!</strong> You must have a DUO account before enabling this module.<br/><p>]]>
                </comment>
                <field id="ikey" translate="label comment" type="obscure" showInDefault="1" showInWebsite="1" showInStore="0">
                    <label>Integration Key</label>
                    <backend_model>Magento\Config\Model\Config\Backend\Encrypted</backend_model>
                    <comment>The Integration Key from the Duo Security admin dashboard integrations page</comment>
                </field>
                <field id="skey" translate="label comment" type="obscure" showInDefault="1" showInWebsite="1" showInStore="0">
                    <label>Secret Key</label>
                    <backend_model>Magento\Config\Model\Config\Backend\Encrypted</backend_model>
                    <comment>The Secret Key from the Duo Security admin dashboard integrations page</comment>
                </field>
                <field id="host" translate="label comment" type="text" showInDefault="1" showInWebsite="1" showInStore="0">
                    <label>Duo Security API hostname</label>
                    <comment>Supply the API hostname from the Duo Security admin dashboard integrations page</comment>
                </field>
                <field id="akey" translate="label comment" type="obscure" showInDefault="1" showInWebsite="1" showInStore="0">
                    <label>Application Key</label>
                    <backend_model>HE\TwoFactorAuth\Model\Sysconfig\Appkey</backend_model>
                    <comment>
                        <![CDATA[The Application Key is a key you create that is unique for your application. Must be at
                    least 40 characters long. Use the autogenerated key above, or create one of your own.]]>
                    </comment>
                </field>
                <field id="validated" translate="label comment" type="label" showInDefault="1" showInWebsite="1" showInStore="0">
                    <label>Settings Validated</label>
                    <comment>
                        <![CDATA[The authentication settings validation status. Duo authentication can not be used until
                    this field says "VALID"]]>
                    </comment>
                </field>
            </group>
            <group id="google" translate="label" type="text" sortOrder="300" showInDefault="1" showInWebsite="1" showInStore="0">
                <label>Google Authenticate</label>
                <comment>
                    <![CDATA[<p><strong>About Google Authenticate</strong><br/>Google Authenticate is a popular two-factor
                authentication solution. It is free to use, but requires use of a compatible app (freely avaialble
                from Google). </p>
                <p>After enabling this option, the first time a user successfully logs in they will be required scan a
                QR code with their Google Authenticator app in order to setup their Google Authenticator secret code.</p>
                <p><strong>To login with Google Authenticator, users must use the Google Authenticator app:</strong></p>
                <ul>
                    <li><a href="https://itunes.apple.com/us/app/google-authenticator/id388497605?mt=8">For iOS</a></li>
                    <li><a href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&hl=en">For Android</a></li>
                </ul>]]>
                </comment>
            </group>
        </section>
    </system>
</config>
